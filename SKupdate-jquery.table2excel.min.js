!function(e,t,n,a){var l="table2excel",i={exclude:".noExl",name:"Table2Excel",filename:"table2excel",fileext:".xls",exclude_img:!0,exclude_links:!0,exclude_inputs:!0};function o(t,n){this.element=t,this.settings=e.extend({},i,n),this._defaults=i,this._name=l,this.init()}function s(e){return e.filename?e.filename:"table2excel"}o.prototype={init:function(){var t=this;t.template={head:'<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40"><meta http-equiv="content-type" content="application/vnd.ms-excel; charset=UTF-8"><head>\x3c!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets>',sheet:{head:"<x:ExcelWorksheet><x:Name>",tail:"</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet>"},mid:"</x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--\x3e</head><body>",table:{head:"<table>",tail:"</table>"},foot:"</body></html>"},t.tableRows=[],e(t.element).each(function(n,a){var l,i="";e(a).find("tr").not(t.settings.exclude).each(function(n,a){i+="<tr>",e(a).find("td,th").not(t.settings.exclude).each(function(n,a){var l=e(this).attr("rowspan"),o=e(this).attr("colspan");e(a).find(t.settings.exclude).length>0?i+="<td> </td>":(i+="<td",l>0&&(i+=" rowspan='"+l+"' "),o>0&&(i+=" colspan='"+o+"' "),e(a).children().is("select")?i+="/>"+e(a).children().find("option:selected").text()+"</td>":i+="/>"+e(a).html()+"</td>")}),i+="</tr>"}),t.settings.exclude_img&&(l=/(\s+alt\s*=\s*"([^"]*)"|\s+alt\s*=\s*'([^']*)')/i,i=i.replace(/<img[^>]*>/gi,function(e){var t=l.exec(e);return null!==t&&t.length>=2?t[2]:""})),t.settings.exclude_links&&(i=function(e){return e.replace(/<a[^>]*>|<\/a>/gi,"")}(i)),t.tableRows.push(i)}),t.tableToExcel(t.tableRows,t.settings.name,t.settings.sheetName)},tableToExcel:function(a,l,i){var o,c,r,x=this,d="";for(o in x.format=function(e,t){return e.replace(/{(\w+)}/g,function(e,n){return t[n]})},i=void 0===i?"Sheet":i,x.ctx={worksheet:l||"Worksheet",table:a,sheetName:i},d=x.template.head,e.isArray(a)&&Object.keys(a).forEach(function(e){d+=x.template.sheet.head+i+e+x.template.sheet.tail}),d+=x.template.mid,e.isArray(a)&&Object.keys(a).forEach(function(e){d+=x.template.table.head+"{table"+e+"}"+x.template.table.tail}),d+=x.template.foot,a)x.ctx["table"+o]=a[o];if(delete x.ctx.table,!!n.documentMode)if("undefined"!=typeof Blob){d=[d=x.format(d,x.ctx)];var m=new Blob(d,{type:"text/html"});t.navigator.msSaveBlob(m,s(x.settings))}else txtArea1.document.open("text/html","replace"),txtArea1.document.write(x.format(d,x.ctx)),txtArea1.document.close(),txtArea1.focus(),sa=txtArea1.document.execCommand("SaveAs",!0,s(x.settings));else{var h=new Blob([x.format(d,x.ctx)],{type:"application/vnd.ms-excel"});t.URL=t.URL||t.webkitURL,c=t.URL.createObjectURL(h),(r=n.createElement("a")).download=s(x.settings),r.href=c,n.body.appendChild(r),r.click(),n.body.removeChild(r)}return!0}},e.fn[l]=function(t){var n=this;return n.each(function(){e.data(n,"plugin_"+l)||e.data(n,"plugin_"+l,new o(this,t))}),n}}(jQuery,window,document);